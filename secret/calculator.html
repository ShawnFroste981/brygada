<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styl-calc.css">
    <link rel="shortcut icon" href="obrazy/icon/scouter.png">
    <title>Kalkulator Mocy</title>
</head>
<body>
    <header>
        <h1>Kalkulator Mocy</h1>
        <h2>Smocze Jaja</h2>
        <h3>[NIE KANONICZNY]</h3>
    </header>
    <main class="choosing" id="left">
        <h1>Obiekt 1</h1>
        <div class="character">
            <label>Wybierz Postać:</label>
            <select id="character-id">
                
            </select>

            Rozdział?
            <select id="chapter-select">
                <option value="default">/</option>
                <option value="Arc1">Arc1</option>
                <option value="Arc2">Arc2</option>
                <option value="Arc3">Arc3</option>
                <option value="Arc4">Arc4</option>
                <option value="Arc5">Arc5</option>
                <option value="Arc6">Arc6</option>
            </select>

            Czy ta osoba walczyła?
            <select id="is-fighter-select">
                <option value="default">/</option>
                <option value="yes">Tak</option>
                <option value="no">Nie</option>
            </select>

            Czy jest kanoniczny?
            <select id="is-canon-select">
                <option value="default">/</option>
                <option value="yes">Tak</option>
                <option value="no">Nie</option>
            </select>
        </div>

        <div class="form">
            <label>Wybierz Styl:</label>
            <select id="character-form">

            </select>

            Czy jest kanoniczny?
            <select id="is-canonform-select">
                <option value="default">/</option>
                <option value="yes">Tak</option>
                <option value="no">Nie</option>
            </select>
        </div>

        <div class="skill">
            <label>Wybierz Technike:</label>
            <select id="character-skill">

            </select>

            Rodzaj techniki?
            <select id="skilltype-select">
                <option value="default">/</option>
                <option value="attack">Ofensywny</option>
                <option value="defense">Defensywny</option>
                <option value="buff">Wzmacniający</option>
                <option value="debuff">Defensywny</option>
                <option value="movement">Ruch</option>
                <option value="combo">Combo</option>
            </select>

            Czy jest kanoniczny?            
            <select id="is-canonskill-select">
                <option value="default">/</option>
                <option value="yes">Tak</option>
                <option value="no">Nie</option>
            </select>
        </div>

        <div class="power">
            <h2>Wskaźnik Mocy:</h2>
            <div class="formpower">
                <p id="baseformlevel">Bazowa Moc: 0</p>
                <p id="baseformmultiplier">Mnożnik Mocy: 0</p>
                <p id="powerFormlevel">Moc: 0</p>
            </div>
            <div class="skillpower">
                <p id="baseskilllevel">Bazowa Moc Techniki: 0</p>
                <p id="powerskillmultiplier">Mnożnik Mocy Techniki: 0</p>
                <p id="powerSkilllevel">Moc Techniki: 0</p>
            </div>
            <div class="finalpower">
                <p id="finalpowerlevel">Licznik Mocy: 0</p>
            </div>
        </div>
    </main>
    <main class="choosing" id="right">
        <h1>Obiekt 2</h1>
        <div class="character">
            <label>Wybierz Postać:</label>
            <select id="character-id-right">
                
            </select>

            Rozdział?
            <select id="chapter-select-right">
                <option value="default">/</option>
                <option value="Arc1">Arc1</option>
                <option value="Arc2">Arc2</option>
                <option value="Arc3">Arc3</option>
                <option value="Arc4">Arc4</option>
                <option value="Arc5">Arc5</option>
                <option value="Arc6">Arc6</option>
            </select>

            Czy ta osoba walczyła?
            <select id="is-fighter-select-right">
                <option value="default">/</option>
                <option value="yes">Tak</option>
                <option value="no">Nie</option>
            </select>

            Czy jest kanoniczny?
            <select id="is-canon-select-right">
                <option value="default">/</option>
                <option value="yes">Tak</option>
                <option value="no">Nie</option>
            </select>
        </div>

        <div class="form">
            <label>Wybierz Styl:</label>
            <select id="character-form-right">

            </select>

            Czy jest kanoniczny?
            <select id="is-canonform-select-right">
                <option value="default">/</option>
                <option value="yes">Tak</option>
                <option value="no">Nie</option>
            </select>
        </div>

        <div class="skill">
            <label>Wybierz Technike:</label>
            <select id="character-skill-right">

            </select>

            Rodzaj techniki?
            <select id="skilltype-select-right">
                <option value="default">/</option>
                <option value="attack">Ofensywny</option>
                <option value="defense">Defensywny</option>
                <option value="buff">Wzmacniający</option>
                <option value="debuff">Defensywny</option>
                <option value="movement">Ruch</option>
                <option value="combo">Combo</option>
            </select>

            Czy jest kanoniczny?            
            <select id="is-canonskill-select-right">
                <option value="default">/</option>
                <option value="yes">Tak</option>
                <option value="no">Nie</option>
            </select>
        </div>

        <div class="power">
            <h2>Wskaźnik Mocy:</h2>
            <div class="formpower">
                <p id="baseformlevel-right">Bazowa Moc: 0</p>
                <p id="baseformmultiplier-right">Mnożnik Mocy: 0</p>
                <p id="powerFormlevel-right">Moc: 0</p>
            </div>
            <div class="skillpower">
                <p id="baseskilllevel-right">Bazowa Moc Techniki: 0</p>
                <p id="powerskillmultiplier-right">Mnożnik Mocy Techniki: 0</p>
                <p id="powerSkilllevel-right">Moc Techniki: 0</p>
            </div>
            <div class="finalpower">
                <p id="finalpowerlevel-right">Licznik Mocy: 0</p>
            </div>
        </div>
    </main>
    <section>
        <button id="calculate-power">Oblicz Moc</button>
    </section>
    <aside>
        <div class="health-bar">
            <div id="left-bar" class="leftbar"></div>
            <div id="right-bar" class="rightbar"></div>
        </div>
    </aside>

    <script id="characterScript">
        // Database-like structure for characters, forms, and skills
        const characterDatabase = [
            {
                value: 'Human',
                chpt: ['default'],
                fighter: 'no',
                canon: 'yes',
                forms: [
                    { value: 'human-adult', text: 'Adult', power: '100', multiplier: '1', canon: 'yes' },
                    { value: 'human-teen', text: 'Teen', power: '80', multiplier: '1', canon: 'yes' },
                    { value: 'human-kid', text: 'Kid', power: '60', multiplier: '1', canon: 'yes' },
                    { value: 'human-old', text: 'Old', power: '40', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    
                ]
            },
            {
                value: 'Jacob',
                chpt: ['default', 'Arc1', 'Arc2', 'Arc3', 'Arc5'],
                fighter: 'yes',
                canon: 'yes',
                forms: [
                    { value: 'jacob-kid', text: 'Kid', power: '160', multiplier: '1', canon: 'yes' },
                    { value: 'jacob-kid-A', text: 'Kid [Prolog]', power: '150', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    { value: 'flash_dodge', text: 'Flash Dodge', type: 'defense', power: '75', multiplier: '2', canon: 'yes', usage: 'jacob-kid,jacob-kid-A' },
                    { value: 'sweep_kick', text: 'Sweep Kick', type: 'attack', power: '100', multiplier: '1', canon: 'yes', usage: 'jacob-kid,jacob-kid-A' },
                    { value: 'excite_jump', text: 'Excite Jump', type: 'attack', power: '125', multiplier: '1', canon: 'yes', usage: 'jacob-kid' },
                    { value: 'falling_kick', text: 'Falling Kick', type: 'attack', power: '150', multiplier: '1', canon: 'yes', usage: 'jacob-kid' }
                ]
            },
            {
                value: 'Daniel',
                chpt: ['default', 'Arc1', 'Arc2', 'Arc3', 'Arc4', 'Arc5', 'Arc6'],
                fighter: 'yes',
                canon: 'yes',
                forms: [
                    { value: 'daniel-1', text: 'Version 1.0', power: '250', multiplier: '1', canon: 'yes' },
                    { value: 'daniel-2', text: 'Version 1.1', power: '300', multiplier: '1', canon: 'yes' },
                    { value: 'daniel-3', text: 'Version 1.2', power: '400', multiplier: '1', canon: 'yes' },
                    { value: 'daniel-3A', text: 'Version 1.2 [Armor]', power: '400', multiplier: '1.5', canon: 'yes' }
                ],
                skills: [
                    { value: 'flash_appear', text: 'Flash Appear', type: 'attack', power: '50', multiplier: '1', canon: 'yes', usage: 'daniel-1,daniel-2,daniel-3,daniel-3A' },
                    { value: 'energy_blast', text: 'Energy Blast', type: 'attack', power: '100', multiplier: '1', canon: 'yes', usage: 'daniel-1,daniel-2,daniel-3,daniel-3A' },
                    { value: 'energy_charge', text: 'Energy Charge', type: 'buff', power: '50', multiplier: '1', canon: 'yes', usage: 'daniel-1,daniel-2,daniel-3,daniel-3A' },
                    { value: 'try-catch', text: 'Try-Catch', type: 'attack', power: '70', multiplier: '3', canon: 'yes', usage: 'daniel-1,daniel-2,daniel-3,daniel-3A' },
                    { value: 'command_grab', text: 'Command: Grab', type: 'attack', power: '180', multiplier: '1', canon: 'yes', usage: 'daniel-1,daniel-2,daniel-3,daniel-3A' },
                    { value: 'bounds_check', text: 'Bounds Check', type: 'attack', power: '250', multiplier: '1', canon: 'yes', usage: 'daniel-2,daniel-3,daniel-3A' },
                    { value: 'kill_process', text: 'Kill Process', type: 'attack', power: '300', multiplier: '1', canon: 'yes', usage: 'daniel-2,daniel-3,daniel-3A' },
                    { value: 't-i-v-m', text: 'Turn Into Vending Machine', type: 'defense', power: '1000', multiplier: '0.05', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'spin_cycle', text: 'Spin Cycle', type: 'attack', power: '55', multiplier: '3', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'earthquake', text: 'Earthquake', type: 'attack', power: '165', multiplier: '1', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'armor', text: 'Armor', type: 'defense', power: '200', multiplier: '1', canon: 'yes', usage: 'daniel-3' },
                    { value: 'ping', text: 'Ping', type: 'attack', power: '50', multiplier: '1', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'vacuum', text: 'Vacuum', type: 'attack', power: '105', multiplier: '1', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'jetpack', text: 'Jetpack', type: 'movement', power: '175', multiplier: '1', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'kick_user', text: 'Kick User', type: 'attack', power: '150', multiplier: '1', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'boot', text: 'Boot', type: 'attack', power: '135', multiplier: '1', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'crash', text: 'Crash', type: 'attack', power: '175', multiplier: '1', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'optical_beam', text: 'Optical Beam', type: 'attack', power: '70', multiplier: '1', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'concussive_blast', text: 'Concussive Blast', type: 'attack', power: '125', multiplier: '1', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'key_punch', text: 'Key Punch', type: 'attack', power: '80', multiplier: '1', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'grab', text: 'Grab', type: 'attack', power: '10', multiplier: '10', canon: 'yes', usage: 'daniel-3,daniel-3A' },
                    { value: 'burst_cancel', text: 'Burst Cancel', type: 'defense', power: '8', multiplier: '10', canon: 'yes', usage: 'daniel-3,daniel-3A' }
                ]
            },
            {
                value: 'Pola',
                chpt: ['default', 'Arc1', 'Arc2', 'Arc3', 'Arc5'],
                fighter: 'yes',
                canon: 'yes',
                forms: [
                    { value: 'pola-teen', text: 'Teen', power: '140', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    { value: 'axii', text: 'Axii', type: 'debuff', power: '40', multiplier: '1', canon: 'yes', usage: 'pola-teen' },
                    { value: 'yrden', text: 'Yrden', type: 'debuff', power: '90', multiplier: '1', canon: 'yes', usage: 'pola-teen' }
                ]
            },
            {
                value: 'Babunia',
                chpt: ['default', 'Arc1'],
                fighter: 'no',
                canon: 'yes',
                forms: [
                    { value: 'grandma', text: 'Grandma', power: '20', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    
                ]
            },
            {
                value: 'Receptionist',
                chpt: ['default', 'Arc2'],
                fighter: 'yes',
                canon: 'yes',
                forms: [
                    { value: 'receptionist', text: 'Base', power: '150', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    
                ]
            },
            {
                value: 'Sundowner',
                chpt: ['default', 'Arc2'],
                fighter: 'yes',
                canon: 'yes',
                forms: [
                    { value: 'sundowner', text: 'Base', power: '200', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    
                ]
            },
            {
                value: 'Elon Meint',
                chpt: ['default', 'Arc2'],
                fighter: 'no',
                canon: 'yes',
                forms: [
                    { value: 'elonmeint', text: 'Base', power: '105', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    
                ]
            },
            {
                value: 'Knuckles',
                chpt: ['default', 'Arc3'],
                fighter: 'no',
                canon: 'yes',
                forms: [
                    { value: 'knuckles', text: 'Base', power: '90', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    
                ]
            },
            {
                value: 'Salamin',
                chpt: ['default', 'Arc4'],
                fighter: 'yes',
                canon: 'yes',
                forms: [
                    { value: 'salami_knive', text: 'Knifer', power: '120', multiplier: '1', canon: 'yes' },
                    { value: 'salami_shuriken', text: 'Shurikener', power: '140', multiplier: '1', canon: 'yes' },
                    { value: 'salami_pistol', text: 'Shooter', power: '175', multiplier: '1', canon: 'yes' },
                    { value: 'salami_machette', text: 'Macheter', power: '150', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    
                ]
            },
            {
                value: 'Frederick',
                chpt: ['default', 'Arc5'],
                fighter: 'no',
                canon: 'yes',
                forms: [
                    { value: 'frederick', text: 'Base', power: '135', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    
                ]
            },
            {
                value: 'Hector Barbossa',
                chpt: ['default', 'Arc5'],
                fighter: 'no',
                canon: 'yes',
                forms: [
                    { value: 'hectorbarbossa', text: 'Base', power: '200', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    
                ]
            },
            {
                value: 'Ayshowee',
                chpt: ['default', 'Arc6'],
                fighter: 'yes',
                canon: 'yes',
                forms: [
                    { value: 'ayshowee', text: 'The Prince', power: '400', multiplier: '1', canon: 'yes' },
                    { value: 'ayshowee-S', text: 'The Prince [I Show SPEED!]', power: '800', multiplier: '1', canon: 'yes' }
                ],
                skills: [
                    { value: 't-s-i-r', text: 'Turn Someone Into Ragdoll', type: 'attack', power: '1000', multiplier: '0.1', canon: 'yes', usage: 'ayshowee,ayshowee-S' },
                    { value: 'bunker_kick', text: 'Bunker Kick', type: 'attack', power: '140', multiplier: '1', canon: 'yes', usage: 'ayshowee,ayshowee-S' },
                    { value: 'ape_style', text: 'Ape Style', type: 'movement', power: '110', multiplier: '1', canon: 'yes', usage: 'ayshowee,ayshowee-S' },
                    { value: 'sweep_kick', text: 'Sweep Kick', type: 'attack', power: '125', multiplier: '1', canon: 'yes', usage: 'ayshowee,ayshowee-S' },
                    { value: 'jungle_pounce', text: 'Jungle Pounce', type: 'movement', power: '200', multiplier: '1', canon: 'yes', usage: 'ayshowee,ayshowee-S' },
                    { value: 'desert_darts', text: 'Desert Darts', type: 'debuff', power: '100', multiplier: '1', canon: 'yes', usage: 'ayshowee,ayshowee-S' },
                    { value: 'monkey_grab', text: 'Monkey Grab', type: 'defense', power: '110', multiplier: '1', canon: 'yes', usage: 'ayshowee,ayshowee-S' },
                    { value: 'monkey_uppercut', text: 'Monkey Uppercut', type: 'attack', power: '285', multiplier: '1', canon: 'yes', usage: 'ayshowee,ayshowee-S' },
                    { value: 'monkey_flurry', text: 'Monkey Flurry', type: 'attack', power: '160', multiplier: '1', canon: 'yes', usage: 'ayshowee' },
                    { value: 'grab', text: 'Grab', type: 'attack', power: '10', multiplier: '10', canon: 'yes', usage: 'ayshowee,ayshowee-S' },
                    { value: 'i_show_power', text: 'I Show POWER!', type: 'attack', power: '350', multiplier: '1', canon: 'yes', usage: 'ayshowee' },
                    { value: 'i_show_speed', text: 'I Show SPEED!', type: 'buff', power: '400', multiplier: '1', canon: 'yes', usage: 'ayshowee' },
                    { value: 'blink_monkey_flurry', text: 'BLINK Monkey Flurry', type: 'combo', power: '320', multiplier: '1', canon: 'yes', usage: 'ayshowee-S' },
                    { value: 'blink_jungle_pounce', text: 'BLINK Jungle Pounce', type: 'combo', power: '400', multiplier: '1', canon: 'yes', usage: 'ayshowee-S' }
                ]
            }
        ];
    
        const characterSelect = document.getElementById('character-id');
        const chapterSelect = document.getElementById('chapter-select');
        const isFighterSelect = document.getElementById('is-fighter-select');
        const isCanonSelect = document.getElementById('is-canon-select');
        const characterFormSelect = document.getElementById('character-form');
        const isCanonFormSelect = document.getElementById('is-canonform-select');
        const characterSkillSelect = document.getElementById('character-skill');
        const skillTypeSelect = document.getElementById('skilltype-select');
        const isCanonSkillSelect = document.getElementById('is-canonskill-select');

        //right side
        const characterSelectRight = document.getElementById('character-id-right');
        const chapterSelectRight = document.getElementById('chapter-select-right');
        const isFighterSelectRight = document.getElementById('is-fighter-select-right');
        const isCanonSelectRight = document.getElementById('is-canon-select-right');
        const characterFormSelectRight = document.getElementById('character-form-right');
        const isCanonFormSelectRight = document.getElementById('is-canonform-select-right');
        const characterSkillSelectRight = document.getElementById('character-skill-right');
        const skillTypeSelectRight = document.getElementById('skilltype-select-right');
        const isCanonSkillSelectRight = document.getElementById('is-canonskill-select-right');
            
        function updateCharacterOptions() {
            const selectedChapter = chapterSelect.value;
            const selectedFighter = isFighterSelect.value;
            const selectedCanon = isCanonSelect.value;
    
            // Clear the character dropdown
            characterSelect.innerHTML = '';
    
            // Loop through each character and add only those matching the selected criteria
            characterDatabase.forEach(character => {
                const matchesChapter = selectedChapter === 'default' || character.chpt.includes(selectedChapter);
                const matchesFighter = selectedFighter === 'default' || character.fighter === selectedFighter;
                const matchesCanon = selectedCanon === 'default' || character.canon === selectedCanon;
    
                if (matchesChapter && matchesFighter && matchesCanon) {
                    const option = document.createElement('option');
                    option.value = character.value;
                    option.text = character.value;
                    characterSelect.appendChild(option);
                }
            });
    
            updateFormOptions();
            updateSkillOptions();
        }
    
        function updateFormOptions() {
            const selectedCharacter = characterSelect.value;
            const selectedCanonForm = isCanonFormSelect.value;
            const character = characterDatabase.find(char => char.value === selectedCharacter);
    
            // Clear the form dropdown
            characterFormSelect.innerHTML = '';
    
            if (character) {
                character.forms.forEach(form => {
                    const matchesCanonForm = selectedCanonForm === 'default' || form.canon === selectedCanonForm;
    
                    if (matchesCanonForm) {
                        const option = document.createElement('option');
                        option.value = form.value;
                        option.text = form.text;
                        characterFormSelect.appendChild(option);
                    }
                });
            }
    
            updateSkillOptions(); // Update skills based on the selected form
        }
    
        function updateSkillOptions() {
            const selectedCharacter = characterSelect.value;
            const selectedForm = characterFormSelect.value;
            const selectedCanonSkill = isCanonSkillSelect.value;
            const selectedSkillType = skillTypeSelect.value;
            const character = characterDatabase.find(char => char.value === selectedCharacter);

            // Clear the skill dropdown
            characterSkillSelect.innerHTML = '';

            // Add the default skill option
            const defaultSkillOption = document.createElement('option');
            defaultSkillOption.value = '/';
            defaultSkillOption.text = '/';
            characterSkillSelect.appendChild(defaultSkillOption);

            if (character) {
                character.skills.forEach(skill => {
                    const matchesCanonSkill = selectedCanonSkill === 'default' || skill.canon === selectedCanonSkill;
                    const matchesSkillType = selectedSkillType === 'default' || skill.type === selectedSkillType;
                    const canBeUsedInForm = skill.usage.split(',').includes(selectedForm);

                    if (matchesCanonSkill && matchesSkillType && canBeUsedInForm) {
                        const option = document.createElement('option');
                        option.value = skill.value;
                        option.text = skill.text;
                        characterSkillSelect.appendChild(option);
                    }
                });
            }
        }

        //right side
        function updateCharacterOptionsRight() {
            const selectedChapter = chapterSelectRight.value;
            const selectedFighter = isFighterSelectRight.value;
            const selectedCanon = isCanonSelectRight.value;

            characterSelectRight.innerHTML = '';

            characterDatabase.forEach(character => {
                const matchesChapter = selectedChapter === 'default' || character.chpt.includes(selectedChapter);
                const matchesFighter = selectedFighter === 'default' || character.fighter === selectedFighter;
                const matchesCanon = selectedCanon === 'default' || character.canon === selectedCanon;

                if (matchesChapter && matchesFighter && matchesCanon) {
                    const option = document.createElement('option');
                    option.value = character.value;
                    option.text = character.value;
                    characterSelectRight.appendChild(option);
                }
            });

            updateFormOptionsRight();
            updateSkillOptionsRight();
        }

        function updateFormOptionsRight() {
            const selectedCharacter = characterSelectRight.value;
            const selectedCanonForm = isCanonFormSelectRight.value;
            const character = characterDatabase.find(char => char.value === selectedCharacter);

            characterFormSelectRight.innerHTML = '';

            if (character) {
                character.forms.forEach(form => {
                    const matchesCanonForm = selectedCanonForm === 'default' || form.canon === selectedCanonForm;

                    if (matchesCanonForm) {
                        const option = document.createElement('option');
                        option.value = form.value;
                        option.text = form.text;
                        characterFormSelectRight.appendChild(option);
                    }
                });
            }

            updateSkillOptionsRight();
        }

        function updateSkillOptionsRight() {
            const selectedCharacter = characterSelectRight.value;
            const selectedForm = characterFormSelectRight.value;
            const selectedCanonSkill = isCanonSkillSelectRight.value;
            const selectedSkillType = skillTypeSelectRight.value;
            const character = characterDatabase.find(char => char.value === selectedCharacter);

            characterSkillSelectRight.innerHTML = '';

            const defaultSkillOption = document.createElement('option');
            defaultSkillOption.value = '/';
            defaultSkillOption.text = '/';
            characterSkillSelectRight.appendChild(defaultSkillOption);

            if (character) {
                character.skills.forEach(skill => {
                    const matchesCanonSkill = selectedCanonSkill === 'default' || skill.canon === selectedCanonSkill;
                    const matchesSkillType = selectedSkillType === 'default' || skill.type === selectedSkillType;
                    const canBeUsedInForm = skill.usage.split(',').includes(selectedForm);

                    if (matchesCanonSkill && matchesSkillType && canBeUsedInForm) {
                        const option = document.createElement('option');
                        option.value = skill.value;
                        option.text = skill.text;
                        characterSkillSelectRight.appendChild(option);
                    }
                });
            }
        }

        characterSelect.addEventListener('change', updateFormOptions);
        characterFormSelect.addEventListener('change', updateSkillOptions);
        chapterSelect.addEventListener('change', updateCharacterOptions);
        isFighterSelect.addEventListener('change', updateCharacterOptions);
        isCanonSelect.addEventListener('change', updateCharacterOptions);
        isCanonFormSelect.addEventListener('change', updateFormOptions);
        isCanonSkillSelect.addEventListener('change', updateSkillOptions);
        skillTypeSelect.addEventListener('change', updateSkillOptions);

        updateCharacterOptions(); // Initial population of character options

        //right side
        characterSelectRight.addEventListener('change', updateFormOptionsRight);
        characterFormSelectRight.addEventListener('change', updateSkillOptionsRight);
        chapterSelectRight.addEventListener('change', updateCharacterOptionsRight);
        isFighterSelectRight.addEventListener('change', updateCharacterOptionsRight);
        isCanonSelectRight.addEventListener('change', updateCharacterOptionsRight);
        isCanonFormSelectRight.addEventListener('change', updateFormOptionsRight);
        isCanonSkillSelectRight.addEventListener('change', updateSkillOptionsRight);
        skillTypeSelectRight.addEventListener('change', updateSkillOptionsRight);

        updateCharacterOptionsRight(); // Initial population of character options on the right side

        document.getElementById('calculate-power').addEventListener('click', () => {
            // Left side calculations
            const selectedCharacter = characterSelect.value;
            const selectedForm = characterFormSelect.value;
            const selectedSkill = characterSkillSelect.value;

            const character = characterDatabase.find(char => char.value === selectedCharacter);
            const form = character.forms.find(f => f.value === selectedForm);

            let skillPower = 0;
            let skillMultiplier = 0;

            if (selectedSkill !== '/') {
                const skill = character.skills.find(s => s.value === selectedSkill);
                if (skill) {
                    skillPower = parseFloat(skill.power);
                    skillMultiplier = parseFloat(skill.multiplier);
                }
            }

            // Display base values for left
            document.getElementById('baseformlevel').textContent = `Bazowa Moc: ${form.power}`;
            document.getElementById('baseformmultiplier').textContent = `Mnożnik Mocy: ${form.multiplier}`;
            document.getElementById('baseskilllevel').textContent = `Bazowa Moc Techniki: ${skillPower}`;
            document.getElementById('powerskillmultiplier').textContent = `Mnożnik Mocy Techniki: ${skillMultiplier}`;

            const formPower = parseFloat(form.power) * parseFloat(form.multiplier);
            const skillPowerWithMultiplier = skillPower * skillMultiplier;

            document.getElementById('powerFormlevel').textContent = `Moc: ${formPower}`;
            document.getElementById('powerSkilllevel').textContent = `Moc Techniki: ${skillPowerWithMultiplier}`;

            const finalPowerLeft = formPower + skillPowerWithMultiplier;
            document.getElementById('finalpowerlevel').textContent = `Licznik Mocy: ${finalPowerLeft}`;

            // Right side calculations
            const selectedCharacterRight = characterSelectRight.value;
            const selectedFormRight = characterFormSelectRight.value;
            const selectedSkillRight = characterSkillSelectRight.value;

            const characterRight = characterDatabase.find(char => char.value === selectedCharacterRight);
            const formRight = characterRight.forms.find(f => f.value === selectedFormRight);

            let skillPowerRight = 0;
            let skillMultiplierRight = 0;

            if (selectedSkillRight !== '/') {
                const skillRight = characterRight.skills.find(s => s.value === selectedSkillRight);
                if (skillRight) {
                    skillPowerRight = parseFloat(skillRight.power);
                    skillMultiplierRight = parseFloat(skillRight.multiplier);
                }
            }

            // Display base values for right
            document.getElementById('baseformlevel-right').textContent = `Bazowa Moc: ${formRight.power}`;
            document.getElementById('baseformmultiplier-right').textContent = `Mnożnik Mocy: ${formRight.multiplier}`;
            document.getElementById('baseskilllevel-right').textContent = `Bazowa Moc Techniki: ${skillPowerRight}`;
            document.getElementById('powerskillmultiplier-right').textContent = `Mnożnik Mocy Techniki: ${skillMultiplierRight}`;

            const formPowerRight = parseFloat(formRight.power) * parseFloat(formRight.multiplier);
            const skillPowerWithMultiplierRight = skillPowerRight * skillMultiplierRight;

            document.getElementById('powerFormlevel-right').textContent = `Moc: ${formPowerRight}`;
            document.getElementById('powerSkilllevel-right').textContent = `Moc Techniki: ${skillPowerWithMultiplierRight}`;

            const finalPowerRight = formPowerRight + skillPowerWithMultiplierRight;
            document.getElementById('finalpowerlevel-right').textContent = `Licznik Mocy: ${finalPowerRight}`;

            // Update health bar widths based on final power levels
            const leftBar = document.getElementById('left-bar');
            const rightBar = document.getElementById('right-bar');

            const totalPower = finalPowerLeft + finalPowerRight;
            const leftBarPercentage = (finalPowerLeft / totalPower) * 100;
            const rightBarPercentage = (finalPowerRight / totalPower) * 100;

            leftBar.style.width = `${leftBarPercentage}%`;
            rightBar.style.width = `${rightBarPercentage}%`;
        });
    </script>
</body>
</html>